# Sakura_embybossï¼ˆä½“éªŒç‰ˆï¼‰

![Sakura](./image/sakura.png)

# æœ€è¿‘æ›´æ–°è¯´æ˜

-
    1. æœ¬æ¬¡æ›´æ–°ä¸»è¦æ˜¯ä¼˜åŒ–ä»£ç ï¼Œæ–°åŠŸèƒ½è¿˜åœ¨è·¯ä¸Š
-
    2. å¦‚æœä½ ä¹‹å‰å·²ç»éƒ¨ç½²è¿‡äº†ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹è¯´æ˜ï¼š

    - æœ¬é¡¹ç›®æ›´æ–°ç®¡ç†æ•°æ®åº“æ–¹æ³•ï¼Œè¯·å…ˆå¤‡ä»½å½“å‰çš„æ•°æ®åº“
    - æ¥ç€æ‰‹åŠ¨åœ¨æ—§`emby`è¡¨æœ«å°¾åŠ ä¸€ä¸ªå­—æ®µ`ch`ï¼Œé»˜è®¤ä¸º`NULL`ï¼Œç±»å‹ä¸º`datetime`
    - å…¶ä»–å†…å®¹ï¼šä¸ºäº†é€‚é…æ–°åŠŸèƒ½ï¼Œå°†åŸæœ‰çš„æ•°æ®è¡¨`invite`æ”¹å`Rcode`ï¼Œæ–°Rcodeè¡¨ä¼šç”±ç¨‹åºè‡ªåŠ¨ç”Ÿæˆæ‰€ä»¥æ— éœ€å…¶ä»–æ“ä½œ
    - `config.json`æ–‡ä»¶ä¸­çš„å­—æ®µåå­—æœ‰æ‰€æ›´æ”¹ï¼Œè¯·ä¸‹ç¿»ç»“åˆ é…ç½®æ–‡ä»¶å¡«å†™ã€`config_example.json`è¿›è¡Œæ›´æ”¹
    - æ‹‰å–ä»£ç æ›´æ–°å³å¯
-
    3. å¦‚æœä¹‹å‰æ²¡æœ‰éƒ¨ç½²è¿‡ï¼Œè¯·ç…§ä¸‹é¢æ­¥éª¤åˆ›å»ºå³å¯

## é¡¹ç›®è¯´æ˜

- æœ¬é¡¹ç›®æ˜¯ **ä¸šä½™é€‰æ‰‹** å†™å°±ï¼Œç»“åˆä¸€äº›æˆ‘æ‰€è®¤ä¸ºä¼˜è´¨çš„ç‰¹ç‚¹ã€å…ƒç´ ï¼Œæˆªè‡³ç›®å‰æˆ‘è‡ªå·±éƒ½ä¸çŸ¥é“æœ‰ä»€ä¹ˆäº†
- æ²¡æœ‰ç³»ç»Ÿçš„å­¦ä¹ ä»£ç ï¼Œåœ¨é€»è¾‘ä¸Šä¼šæ¯”è¾ƒä¹±åŒ…æ‹¬å¾ˆå¤šçš„æ–¹é¢å…¶å®å¹¶ä¸å®Œç¾ï¼Œä½†æ˜¯èƒ½è·‘
- æ¨èä½¿ç”¨ Debian 11 æ­å»ºï¼Œæ¯”è¾ƒå…¼å®¹
- è§£å†³ä¸äº†å¤§çš„æŠ€æœ¯é—®é¢˜ï¼Œå¦‚éœ€è¦ï¼Œè¯·è‡ªè¡Œforkä¿®æ”¹ï¼Œ~~å¦‚æœèƒ½æç‚¹æœ‰æ„æ€çš„præ›´å¥½å•¦~~
- å¦‚æœä½ æ­å»ºå¥½äº†è¯·å¸¦å¸¦æˆ‘ä»¬ï¼ˆéå¿…é¡»ï¼‰ [@HARiA](https://github.com/berry8838) And [@ç½—å®](https://github.com/dddddluo)
- **å£°æ˜ï¼šæœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œä»…ä½œä¸ºè¾…åŠ©å·¥å…·å€ŸåŠ©tgå¹³å°æ–¹ä¾¿ç”¨æˆ·ç®¡ç†è‡ªå·±çš„åª’ä½“åº“æˆå‘˜ï¼Œå¯¹ç”¨æˆ·çš„å…¶ä»–è¡Œä¸ºåŠå†…å®¹æ¯«ä¸çŸ¥æƒ…**

## åŠŸèƒ½ä¸€è§ˆ

- [x] ç”¨æˆ·é¢æ¿
    - [x] åˆ›å»ºè´¦æˆ·
    - [x] ç»‘å®šæœªç™»è®°è´¦æˆ·ã€æ¢ç»‘TG
    - [x] å…‘æ¢æ³¨å†Œç 
    - [x] é‡ç½®å¯†ç 
    - [x] åˆ é™¤è´¦æˆ·
    - [x] æ˜¾ç¤ºéšè—åª’ä½“åº“ï¼ˆé»˜è®¤ä¸æ˜¾ç¤º `æ’­æ”¾åˆ—è¡¨`å’Œ`åˆé›†`ï¼‰
- [x] **æœåŠ¡å™¨**
    - [x] æŸ¥çœ‹æœåŠ¡å™¨ä¿¡æ¯ç½‘é€Ÿè´Ÿè½½ç­‰ æ˜¾ç¤ºembyçº¿è·¯ï¼Œå¯†ç ï¼Œæ’­æ”¾äººæ•°
    - [x] æ”¯æŒå¤šæœåŠ¡å™¨æŸ¥çœ‹
- [x] **adminé¢æ¿**
    - [x] ç®¡ç†æ³¨å†Œ ->æ€»é™é¢ï¼ŒçŠ¶æ€ï¼Œå®šæ—¶æ³¨å†Œ
    - [x] åˆ›å»ºä»¥åŠç®¡ç†é‚€è¯·ç  -> codeä¸æ·±é“¾æ¥ ä¸¤ç§å½¢å¼
    - [x] æŸ¥çœ‹é‚€è¯·ç 
- [x] **configé¢æ¿**
    - [x] å¯¼å‡ºæ—¥å¿—
    - [x] botå†…è®¾ç½®æ¢é’ˆï¼Œembyå±•ç¤ºçº¿è·¯ï¼ŒæŒ‡å®šæ˜¾éšåª’ä½“åº“ï¼Œæ§åˆ¶æ³¨å†Œç ç»­æœŸï¼Œè‡ªå®šä¹‰å¼€å…³å……ç”µæŒ‰é’®
- [x] **è¿›é˜¶**
    - [x] æç¤ºåŠ ç¾¤ã€é€€ç¾¤åˆ å·ã€è¢«æ‹‰å…¥éæˆæƒç¾¤æŠ¥è­¦å¹¶é€€å‡º
    - [x] å‘½ä»¤åˆå§‹åŒ–æ ¹æ®èº«ä»½æ˜¾ç¤ºä¸åŒçš„çš„å‘½ä»¤
    - [x] å„ç§å‘½ä»¤ç®¡ç† [éƒ¨åˆ†æ•ˆæœå›¾å’Œå‘½ä»¤çœ‹è¿™é‡Œ](https://telegra.ph/embyboss-05-29)
    - [x] æ·»åŠ ç”¨æˆ·æ’­æ”¾æ—¶é•¿ï¼Œåª’ä½“æ’­æ”¾æ•°æ’è¡Œæ¦œæ—¥æ¨å‘¨æ¨ [EmbyTools](https://github.com/Nolovenodie/EmbyTools)
    - [x] **æ”¯æŒdockeréƒ¨ç½²**
- [ ] è¿›é˜¶çš„å¾…å®šæƒ³æ³•(æœ‰äº›ä¸ä¸€å®šåš)
    - [ ] ç¡çœ æ¨¡å¼
    - [ ] é‡æ–°å¯ç”¨ç­¾åˆ°
    - [ ] å¼€å¯å•†åº—å…‘æ¢
    - [ ] æ·»åŠ é‚€è¯·åŠŸèƒ½
    - [ ] ç®¡ç†ç™½åå•
    - [ ] æ–—ç‰›ç©ç‰Œ
    - [ ] æ§åˆ¶è®¾å¤‡æ•°
    - [ ] æ·»åŠ Embyä¸­çš„æ›´æ–°æ¨é€
    - [ ] æ·»åŠ æ”¶è—å½±ç‰‡æ¨é€?
    - [ ] å…¬å‘ŠåŠŸèƒ½(ç¾¤å‘ä¿¡æ¯,é¢‘é“ç®¡ç†åŠ æŒ‰é’®ç­‰)

## ä½¿ç”¨å¸®åŠ©

- [éƒ¨åˆ†æ•ˆæœå›¾å’Œå‘½ä»¤å¤§å…¨çœ‹è¿™é‡Œ](https://telegra.ph/embyboss-05-29)
- åœ¨telegramä¸­ï¼Œé»˜è®¤çš„å‘½ä»¤ç¬¦ä¸º`/`ï¼Œä½†æ˜¯ä¸ºé¿å…ç¾¤èŠä¸­æ™®é€šæˆå‘˜ä¹±ç‚¹ï¼Œembybosså°†å‘½ä»¤ç¬¦å¤šæ·»åŠ ä¸‰ç§  
  å³å‘½ä»¤ä½¿ç”¨ ï¼š`/start = .start = #start = !start = ã€‚start`
- è¯·ç»™botæ‰“å¼€ åˆ é™¤æ¶ˆæ¯ã€ç½®é¡¶æ¶ˆæ¯ï¼Œè¸¢å‡ºæˆå‘˜æƒé™

## é…ç½®è¯´æ˜

### 1ã€æ‹‰å–ä»£ç 

- ä¸‹è½½æºç åˆ°æœ¬åœ°

```
sudo apt install python3-pip
git clone https://github.com/berry8838/Sakura_embyboss.git && cd Sakura_embyboss && chmod +x main.py
```

---------------------

### 2ã€å®‰è£…æ•°æ®åº“

- ~~æœ‰ä¸¤ç§æ–¹å¼é…ç½®æ•°æ®åº“ã€‚åˆ†åˆ«è¯´ï¼Œä»»é€‰ä¸€ç§~~
- å·²å®ç°è‡ªåŠ¨åˆ›å»ºï¼Œè¯·ç¡®ä¿å®‰è£…å¥½æ•°æ®åº“ã€èƒ½è”é€šå³å¯
- ä»¥ä¸‹æ•°æ®åº“ç®¡ç†è½¯ä»¶å‡å¸ƒç½®åœ¨ vps ä¸Šï¼Œæ¸©é¦¨æç¤ºï¼šå‡†å¤‡å¥½æ¯éš”ä¸€æ®µæ—¶é—´çš„**æ•°æ®åº“å¤‡ä»½ï¼**
- è¿˜æœ‰ä¸€ä»¶äº‹ï¼Œä»¥ä¸‹å®‰è£…çš„æ—¶å€™è¯·ç¡®ä¿æŒæ¡ -> æ•°æ®åº“çš„ipï¼Œç”¨æˆ·åï¼Œå¯†ç ï¼Œæ•°æ®åº“åï¼ŒæœåŠ¡å™¨å­—ç¬¦é›†ä¸ºUTF-8 Unicode (utf8mb4)

#### dockerå®‰è£…æ•°æ®åº“ (1)

- ç”¨docker-composeä¸€æ­¥åˆ°ä½ã€‚
  å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£…dockerã€docker composeï¼Œä¸‹é¢æ˜¯å®‰è£…æ­¥éª¤ï¼š

```shell
curl -fsSL https://get.docker.com | bash -s docker
curl -L "https://github.com/docker/compose/releases/download/v2.10.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

systemctl start docker 
systemctl enable docker
```

- æ¥ç€åœ¨Sakura_embybossç›®å½•ä¸‹é¢æ‰¾åˆ°æ–‡ä»¶`docker-compose.yml`ï¼Œä¿®æ”¹æˆè‡ªå·±çš„è®¾ç½®åä¿å­˜ã€‚
- åœ¨Sakura_embybossç›®å½•è¿è¡Œå‘½ä»¤`docker-compose up -d`ã€‚
- æ­å»ºå®Œæˆä¹‹åï¼Œç”¨ `ip:ç«¯å£` è®¿é—®ã€ç®¡ç†

#### å®‰è£…æ•°æ®åº“ï¼ˆ2ï¼‰

- åœ¨ä½ å·²ç»æ‹¥æœ‰å®å¡”é¢æ¿å‰æä¸‹ä½¿ç”¨å®å¡”é¢æ¿
- åœ¨å®å¡”ä¸­ï¼Œå®‰è£…å¥½mysqlï¼Œphpmyadminï¼Œè¿›å…¥`æ•°æ®åº“` æ–°å¢åŠ ä¸€ä¸ªæ•°æ®åº“ï¼Œç”¨æˆ·åå¯†ç è®¾ç½®ï¼Œè¿›è¡Œç›¸åº”çš„æ›¿æ¢ï¼Œè®¿é—®ç‚¹å‡» `phpmyadmin`  
  ![å®å¡”](./image/bt.png)

------------------

### 3ã€é…ç½®æ–‡ä»¶å¡«å†™

- æ‰“å¼€æ–‡ä»¶`config_example.json`ï¼Œå‚è€ƒä¸‹åˆ—è¯´æ˜å¡«å†™è‡ªå·±çš„å†…å®¹ï¼ˆbotï¼Œæ•°æ®åº“ï¼Œembyç­‰ç­‰ï¼‰
- å¡«å†™å®Œæ•´ä»¥åæ”¹åæˆ`config.json`
- å¿…å¡«é¡¹ç›®

```
"bot_name": ""    botçš„usernameï¼Œæ¯”å¦‚æˆ‘çš„æœºå™¨äºº@keaiji1_botï¼Œå°±å¡«keaiji1_bot
"bot_token": ""   botçš„API token
"owner_api": ""   ä½ çš„api  https://my.telegram.org/auth
"owner_hash": ""  ä½ çš„hash  https://my.telegram.org/auth
"owner":          æ‹¥æœ‰è€…çš„tgid
"group": []       æˆæƒç¾¤ç»„id (å¦‚ -1001869392674)ï¼Œæœªæˆæƒçš„ç¾¤ç»„æ‹‰botä¼šè‡ªåŠ¨é€€å‡ºã€‚ä¸åœ¨ç¾¤ç»„çš„æˆå‘˜ä¼šæç¤ºå…ˆåŠ å…¥ç¾¤ç»„
"main_group":""   ä½ ç¾¤ç»„çš„ç”¨æˆ·åæˆ–è€…ä½ ç§å¯†ç¾¤ç»„çš„é‚€è¯·é“¾æ¥ï¼Œæ²¡æœ‰çš„è¯å°±éšä¾¿å¡«ä¸ª Google.com å§  
                  å¦‚ https://t.me/+7ZL9MbJd8h44Zjc1 ä¸­çš„ "+7ZL9MbJd8h44Zjc1"              
"chanel": ""      ä½ é¢‘é“username (ä¸åŠ @)ï¼Œæ²¡æœ‰çš„è¯å°±éšä¾¿å¡«ä¸ª Google.com å§
"bot_photo":     "https://telegra.ph/file/1437f7f348c6c71f0b9ab.png",
                  botå‘é€æ¶ˆæ¯æ—¶çš„å›¾ï¼Œå¿…è¦                  
"admins": []      æ‹¥æœ‰ç®¡ç†æƒé™çš„id 1661037800 è®°å¾—è¦å¡«å…¥owneré‡Œçš„tgidï¼Œå…¶ä»–æ·»åŠ idè¦ç”¨è‹±æ–‡é€—å·éš”å¼€  
"money": "èŠ±å¸"    æœªæ¥æ–°åŠŸèƒ½è´§å¸çš„åç§°
"emby_api": ""    embyçš„apiï¼Œåœ¨åå°è‡ªå·±åˆ›å»ºä¸€ä¸ª
"emby_url": ""    å»ºè®®ipï¼Œhttp://255.255.255.36:8096 æœ€åä¸å¸¦æ–œæ ï¼Œæ˜¯å‘é€ç»™enbyçš„ç½‘å€ï¼Œå¡«åŸŸåè¯·ä¿è¯åä»£ä¸ä¼šæŒ‚
"emby_line": ""   å±•ç¤ºç»™ç”¨æˆ·çš„embyåœ°å€

"db_host": ""     å¦‚ä¸Šï¼Œæ•°æ®åº“çš„ip å¦‚ï¼š255.255.255.36 ä¸éœ€è¦3306ç«¯å£ï¼Œé»˜è®¤çš„
"db_user": "susu" æ•°æ®åº“ç”¨æˆ·å
"db_pwd": "1234"  å¯†ç 
"db_name": "embyboss"  åº“å
"ranks": {
    "logo": "SAKURA",  æ—¥æ¦œ/å‘¨æ¦œæ¨é€æ¦œå•å›¾ç‰‡ä¸­çš„LOGOæ–‡å­—
    "backdrop": false   æ˜¯å¦ä½¿ç”¨backdropä½œä¸ºæ¨é€æ¦œå•çš„å°é¢å›¾
}
```

- ä¸å¡«é¡¹ç›®

```
"user_buy": {
    "stat": "n",
    "text": "**ğŸ›’è¯·é€‰æ‹©è´­ä¹°å¯¹åº”æ—¶é•¿çš„å¥—é¤ï¼š**ç½‘é¡µä»˜æ¬¾åä¼šå‘é‚€è¯·ç è¿æ¥ï¼Œç‚¹å‡»è·³è½¬åˆ°botå¼€å§‹æ³¨å†Œå’Œç»­æœŸç¨‹å¼ã€‚",
    "button": [
      [
        "Google",
        "Google.com",
        "url"
      ]
    ]
  } stat å¼€å¯å……ç”µæŒ‰é’®ï¼Œå»ºè®®é»˜è®¤å…³é—­ï¼Œå¯åœ¨bot->/configé‡Œè‡ªè¡Œé…ç½®ï¼Œtextæ˜¯æ˜¾ç¤ºæ–‡æœ¬ï¼Œbutoonä¸ºé”®ç›˜
"open": "n",    æ˜¯å¦å¼€å¯è‡ªç”±æ³¨å†Œã€‚
"buy": [],      è´­ä¹°æŒ‰é’®çš„æ ·å¼ï¼Œä¸å¡«ï¼Œç­‰botèµ·æ¥å»é‡Œé¢è®¾ç½®ã€‚æŠ¥é”™å¾ˆéº»çƒ¦
"invite": "n",  æ²¡å†™å¥½ï¼Œå¯ä»¥å¿½ç•¥
"block":[]      ä¸å¡«ï¼Œç¡®ä¿æœ‰è¿™ä¸ªå­—æ®µå°±è¡Œã€‚ç­‰botèµ·æ¥å»é‡Œé¢è®¾ç½®
"tz_ad": "",    æ¢é’ˆåœ°å€ï¼Œå½¢å¦‚ï¼šhttps://xx.xx.xyzæˆ–http://25.25.25.25:8008 æœ€åä¸å¸¦æ–œæ 
"tz_api": "",
"tz_id": []     tzå¼€å¤´çš„ä¸‰é¡¹æ˜¯å’Œ nezha æ¢é’ˆåœ¨ä¸€èµ·çš„é¡¹ç›®ï¼Œæ²¡æœ‰å“ªå’æ¢é’ˆå°±å¿½ç•¥ã€‚
```

- é¢å¤–çš„ï¼šå¦‚æœä½ å¸Œæœ›ä½ çš„ã€æœåŠ¡å™¨ã€‘å¯ä»¥æ˜¾ç¤ºå¤šæœºå™¨çš„è¯ï¼Œæ¢é’ˆå°±æœ‰ç”¨äº†ï¼Œapiç”Ÿæˆåœ¨nezhaçš„ç®¡ç†åå°ï¼Œidä¹Ÿæ˜¯
  ![tz](./image/fwq.png)

------------

### 4ã€å¯åŠ¨bot (ä¸¤ç§æ–¹å¼)

#### ä¸€ã€docker

- cdï¼ˆåˆ‡æ¢ï¼‰ åˆ° æ–‡ä»¶ç›®å½• Sakura_embybossï¼Œè¿è¡Œä¸‹é¢

```shell
docker run -it --name sakura_embyboss -d --restart=always -v ./config.json:/app/config.json -v ./log:/app/log jingwei520/sakura_embyboss:latest
```

#### äºŒã€æ™®é€š

- ä¾èµ–
  `pip3 install -r requirements.txt`

- åœ¨`embyboss.service`
  é‡Œé¢ç¼–è¾‘æˆ‘ä¸­æ–‡æ ‡æ³¨çš„3è¡Œ,é»˜è®¤å¯ä»¥åˆ†åˆ«å¡«å…¥`embyboss`ï¼Œ`/root/Sakura_embyboss/` ,`/root/Sakura_embyboss/main.py`
- è‹¥æœ‰ä¿®æ”¹è·¯å¾„è¯·æŒ‰ç…§è‡ªå·±çš„ä¿®æ”¹å¡«å†™
- ä¿å­˜åè¿è¡Œ `mv embyboss.service /usr/lib/systemd/system`
- ä»¥ä¸‹æ˜¯æ§åˆ¶å‘½ä»¤

```
systemctl daemon-reload
å¯åŠ¨bot
systemctl start embyboss
botçŠ¶æ€
systemctl status embyboss
é‡å¯bot
systemctl restart embyboss
å¼€æœºè‡ªå¯
systemctl enable embyboss
åœæ­¢bot
systemctl stop embyboss
```

- æ›´æ–°æ–¹æ³•ï¼š

```shell
# æ‹‰å–ä»£ç 
cd /root/Sakura_embyboss
git fetch --all
git reset --hard origin/master
git pull origin master
# æ›´æ–°ä¾èµ–
pip3 install -r requirements.txt
# å¯åŠ¨å‘½ä»¤
systemctl restart embyboss
```

## æ„Ÿè°¢ï¼ˆæ’åºä¸åˆ†å…ˆåï¼‰

- [Pyrogram â€¢ ä¸€ä¸ªç°ä»£ã€ä¼˜é›…å’Œå¼‚æ­¥çš„MTProto APIæ¡†æ¶](https://github.com/pyrogram/pyrogram)
- [Nezhaæ¢é’ˆ â€¢ è‡ªæ‰˜ç®¡ã€è½»é‡çº§ã€æœåŠ¡å™¨å’Œç½‘ç«™ç›‘æ§è¿ç»´å·¥å…·](https://github.com/naiba/nezha)
- [å°å® â€¢ æŒ‰é’®é£æ ¼](https://t.me/EmbyClubBot)
- [MisakaF_Emby â€¢ ä½¿ç”¨EMBY APIçš„æ–¹æ³•](https://github.com/MisakaFxxk/MisakaF_Emby)
- [xiaocao â€¢ serviceå†™æ³•](https://github.com/xiaocao666tzh/EmbyBot)
- [Nolovenodie â€¢ æ’­æ”¾æ¦œå•æµ·æŠ¥æ¨é€](https://github.com/Nolovenodie/EmbyTools)
- [æŠ˜èŠ± â€¢ æ—¥æ¦œå‘¨æ¦œæ¨é€è®¾è®¡å›¾](https://github.com/U41ovo)
  ![bixin](./image/bixin.jpg)
